<!-- dashboard.component.html -->
<div class="dashboard-container">
    <div class="notification" *ngIf="showNotification" [ngClass]="currentNotification?.type">
        <div class="notification-content">
            <h4>{{ currentNotification?.message }}</h4>
            <p>{{ currentNotification?.details }}</p>
        </div>
    </div>
    <header class=" header1  text-white  text-center py-5">
        <h2>Property Manager</h2>
    </header>

    <!-- Navigation Header -->
    <nav class="header">
        <div class="nav-content">
            <div class="nav-group">
                <button class="btn btn-dark" (click)="setProperty()">
                    <i class="bi bi-chat-dots"></i>
                    Messages
                    <!-- <span class="badge" *ngIf="pendingRequestsCount > 0">{{ pendingRequestsCount }}</span> -->
                </button>
                <button class="btn btn-dark" (click)="toggleRequestModal()">
                    <i class="fas fa-inbox"></i>
                    Requests
                    <span class="badge" *ngIf="pendingRequestsCount > 0">{{ pendingRequestsCount }}</span>
                </button>
            </div>
            <div class="nav-group">
                <button class="btn btn-dark">
                    <i class="bi bi-house"></i>
                    Home
                </button>
                <button class="btn btn-dark">
                    <i class="fas fa-users"></i>
                    Buyers
                </button>
                <button class="btn btn-dark" (click)="sellers()">
                    <i class="fas fa-handshake"></i>
                    Sellers
                </button>
                <button class="btn btn-dark">
                    <i class="fas fa-building"></i>
                    Property Details
                </button>
            </div>
            <button class="btn btn-profile" (click)="toggleSidebar()">
                <i class="fas fa-user-circle"></i>
                {{ profile.userCommonDetails.firstName || 'Profile' }}
            </button>
        </div>
    </nav>

    <!-- Request Modal -->
    <div class="modal-container" *ngIf="isRequestModalOpen">
        <div class="modal-overlay" (click)="closeRequestModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h5>{{ currentRequest ? 'Request Details' : 'Request List' }}</h5>
                <div class="modal-actions">
                    <button class="btn btn-icon" *ngIf="currentRequest" (click)="backToList()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="btn-close" (click)="closeRequestModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Request List View -->
            <div class="modal-body" *ngIf="!currentRequest">
                <div class="request-filters">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" [(ngModel)]="searchTerm" placeholder="Search requests..."
                            (input)="filterRequests()" class="form-control">
                    </div>
                    <div class="filter-buttons">
                        <button *ngFor="let status of ['All', 'Pending', 'Accepted', 'Declined']" class="btn btn-filter"
                            [class.active]="currentFilter === status" (click)="filterByStatus(status)">
                            {{ status }}
                        </button>
                    </div>
                </div>

                <div class="requests-list" *ngIf="filteredRequests.length > 0">
                    <div class="request-item" *ngFor="let request of filteredRequests"
                        (click)="viewRequestDetails(request)">
                        <div class="request-info">
                            <div class="request-header">
                                <h6>{{ request.name }}</h6>
                                <span class="status-badge" [ngClass]="request.status.toLowerCase()">
                                    {{ request.status }}
                                </span>
                            </div>
                            <div class="request-details">
                                <span class="category">
                                    <i class="fas" [ngClass]="getCategoryIcon(request.category)"></i>
                                    {{ request.category }}
                                </span>
                                <span class="date">
                                    <i class="fas fa-calendar"></i>
                                    {{ request.date | date:'mediumDate' }}
                                </span>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>

                <div class="no-results" *ngIf="filteredRequests.length === 0">
                    <i class="fas fa-search"></i>
                    <p>No requests found matching your criteria</p>
                </div>
            </div>

            <!-- Request Detail View -->
            <div class="modal-body request-details" *ngIf="currentRequest">
                <div class="detail-section">
                    <div class="detail-header">
                        <span class="status-badge large" [ngClass]="currentRequest.status.toLowerCase()">
                            {{ currentRequest.status }}
                        </span>
                        <span class="date">
                            Submitted on {{ currentRequest.date | date:'medium' }}
                        </span>
                    </div>

                    <div class="info-group">
                        <label>Name</label>
                        <span>{{ currentRequest.name }}</span>
                    </div>

                    <div class="info-group">
                        <label>Category</label>
                        <span class="category">
                            <i class="fas" [ngClass]="getCategoryIcon(currentRequest.category)"></i>
                            {{ currentRequest.category }}
                        </span>
                    </div>

                    <div class="info-group">
                        <label>Email</label>
                        <span>{{ currentRequest.email }}</span>
                    </div>

                    <div class="info-group">
                        <label>Personal Data</label>
                        <span>{{ currentRequest.personalData }}</span>
                    </div>
                </div>
            </div>

            <div class="modal-footer" *ngIf="currentRequest">
                <button class="btn btn-danger" (click)="declineRequest()"
                    [disabled]="currentRequest.status !== 'Pending'">
                    <i class="fas fa-times"></i> Decline
                </button>
                <button class="btn btn-success" (click)="acceptRequest()"
                    [disabled]="currentRequest.status !== 'Pending'">
                    <i class="fas fa-check"></i> Accept
                </button>
            </div>
        </div>
    </div>

    <!-- Sidebar Profile -->
    <app-profile [profile]="profile" [hidden]="isSidebarOpen" ></app-profile>
</div>

<div>
    <router-outlet></router-outlet>
</div>